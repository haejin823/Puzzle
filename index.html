<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì§ì†Œ í¼ì¦ (10x10)</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    margin-top: 30px;
    background: radial-gradient(circle at top, #23395b, #0b1020);
    color: #fdfdfd;
  }

  h2 {
    margin-bottom: 10px;
  }

  #game-container {
    display: inline-block;
    padding: 15px 20px;
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.3);
    box-shadow: 0 0 20px rgba(0,0,0,0.6);
  }

  #board {
    width: 500px;      /* ì „ì²´ í¼ì¦ ë„ˆë¹„ */
    height: 500px;     /* ì „ì²´ í¼ì¦ ë†’ì´ */
    border: 2px solid #f5f5f5;
    margin: 0 auto 12px auto;
    display: grid;
    grid-template-columns: repeat(10, 1fr);  /* 10x10 í¼ì¦ */
    grid-template-rows: repeat(10, 1fr);
    gap: 0;            /* ì¡°ê° ì‚¬ì´ì— ê°„ê²© ì—†ìŒ (í•œ ì¥ì˜ ê·¸ë¦¼ì²˜ëŸ¼ ë³´ì´ê²Œ) */
    position: relative;
    background: #111;
  }

  .piece {
    width: 50px;       /* 500 / 10 */
    height: 50px;      /* 500 / 10 */
    box-sizing: border-box;
    cursor: pointer;
    background-size: 500px 500px; /* ì „ì²´ ì´ë¯¸ì§€ë¥¼ í¼ì¦ í¬ê¸°ì— ë§ì¶¤ */
    transition: transform 0.08s, box-shadow 0.08s;
  }

  .piece:hover {
    transform: scale(1.04);
    box-shadow: 0 0 8px rgba(255,255,255,0.4);
  }

  .selected {
    outline: 2px solid #ffeb3b;
    box-shadow: 0 0 10px rgba(255,235,59,0.8);
  }

  #controls {
    margin-top: 5px;
  }

  button {
    padding: 7px 14px;
    font-size: 13px;
    cursor: pointer;
    border-radius: 4px;
    border: 1px solid #ccc;
    background: #fafafa;
    margin: 0 4px;
  }

  button:hover {
    background: #eee;
  }

  #info {
    margin-top: 5px;
    font-size: 13px;
  }

</style>
</head>
<body>

<h2>ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì§ì†Œ í¼ì¦ (10Ã—10)</h2>

<div id="game-container">
  <div id="board"></div>
  <div id="controls">
    <button id="shuffleBtn">ğŸ”€ ì„ê¸°</button>
    <button id="resetBtn">ì›ë³¸ ìœ„ì¹˜ë¡œ ë¦¬ì…‹</button>
  </div>
  <div id="info">
    <span id="moveCount">ì´ë™ íšŸìˆ˜: 0</span>
  </div>
</div>

<script>
  // ===== ì„¤ì • =====
  const ROWS = 10;
  const COLS = 10;
  const IMAGE_URL = "christmas.jpg";  // â† ê°™ì€ í´ë”ì— ìˆëŠ” í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì´ë¯¸ì§€ íŒŒì¼ ì´ë¦„

  const TILE_SIZE = 50; // 500px / 10ì¡°ê°

  // ===== ì „ì—­ ë³€ìˆ˜ =====
  let selectedIndex = null;     // í˜„ì¬ ì„ íƒëœ íƒ€ì¼ ì¸ë±ìŠ¤
  let moveCounter = 0;

  const board = document.getElementById("board");
  const moveCountSpan = document.getElementById("moveCount");

  // ===== ì´ˆê¸°í™” =====
  function init() {
    board.innerHTML = "";
    selectedIndex = null;
    moveCounter = 0;
    updateMoveCount();

    // 0 ~ (ROWS*COLS-1) ë²ˆí˜¸ë¥¼ ê°€ì§„ ì¡°ê°ì„ ê·¸ëŒ€ë¡œ ìˆœì„œëŒ€ë¡œ ìƒì„±
    for (let i = 0; i < ROWS * COLS; i++) {
      const pieceDiv = document.createElement("div");
      pieceDiv.classList.add("piece");
      pieceDiv.dataset.index = i;   // í˜„ì¬ ìœ„ì¹˜
      pieceDiv.dataset.piece = i;   // ì–´ë–¤ ì¡°ê°ì¸ì§€ (ì›ë˜ ìœ„ì¹˜)

      applyBackgroundPosition(pieceDiv, i);

      pieceDiv.addEventListener("click", onPieceClick);
      board.appendChild(pieceDiv);
    }
  }

  // ===== ë°°ê²½ ìœ„ì¹˜ ì„¤ì • =====
  // pieceNum: 0 ~ (ROWS*COLS-1)
  function applyBackgroundPosition(div, pieceNum) {
    const row = Math.floor(pieceNum / COLS);
    const col = pieceNum % COLS;

    const offsetX = col * TILE_SIZE;
    const offsetY = row * TILE_SIZE;

    div.style.backgroundImage = `url('${IMAGE_URL}')`;
    div.style.backgroundPosition = `-${offsetX}px -${offsetY}px`;
  }

  // ===== íƒ€ì¼ í´ë¦­ ì‹œ ì²˜ë¦¬ =====
  function onPieceClick(e) {
    const clickedDiv = e.currentTarget;
    const idx = parseInt(clickedDiv.dataset.index, 10);

    if (selectedIndex === null) {
      // ì²« ë²ˆì§¸ ì„ íƒ
      selectedIndex = idx;
      clickedDiv.classList.add("selected");
    } else if (selectedIndex === idx) {
      // ê°™ì€ íƒ€ì¼ ë‹¤ì‹œ í´ë¦­ â†’ ì„ íƒ í•´ì œ
      clickedDiv.classList.remove("selected");
      selectedIndex = null;
    } else {
      // ë‘ ë²ˆì§¸ ì„ íƒ â†’ ì„œë¡œ êµí™˜
      swapPieces(selectedIndex, idx);
      clearSelection();
      moveCounter++;
      updateMoveCount();
      checkComplete();
    }
  }

  function clearSelection() {
    const tiles = document.querySelectorAll(".piece");
    tiles.forEach(t => t.classList.remove("selected"));
    selectedIndex = null;
  }

  // ===== ì¡°ê° êµí™˜ =====
  function swapPieces(i, j) {
    const tiles = document.querySelectorAll(".piece");

    const tileA = tiles[i];
    const tileB = tiles[j];

    const pieceA = parseInt(tileA.dataset.piece, 10);
    const pieceB = parseInt(tileB.dataset.piece, 10);

    tileA.dataset.piece = pieceB;
    tileB.dataset.piece = pieceA;

    applyBackgroundPosition(tileA, pieceB);
    applyBackgroundPosition(tileB, pieceA);
  }

  // ===== ì„ê¸° =====
function shuffle() {
    const tiles = document.querySelectorAll(".piece");
    const interiorIndexes = [];

    // ë‚´ë¶€ ì¡°ê°ì˜ index ìˆ˜ì§‘ (ê°€ì¥ìë¦¬ë¥¼ ì œì™¸í•œ 1~8í–‰, 1~8ì—´)
    for (let r = 1; r < ROWS - 1; r++) {
        for (let c = 1; c < COLS - 1; c++) {
            interiorIndexes.push(r * COLS + c);
        }
    }

    // ë‚´ë¶€ ì¡°ê°ë“¤ì˜ piece ê°’ë“¤ì„ ë°°ì—´ë¡œ ì¶”ì¶œ
    const interiorPieces = interiorIndexes.map(idx => {
        return parseInt(tiles[idx].dataset.piece, 10);
    });

    // í”¼ì…”-ì˜ˆì´ì¸  ì…”í”Œë¡œ ë‚´ë¶€ ì¡°ê°ë§Œ ì„ê¸°
    for (let i = interiorPieces.length - 1; i > 0; i--) {
        const r = Math.floor(Math.random() * (i + 1));
        [interiorPieces[i], interiorPieces[r]] = [interiorPieces[r], interiorPieces[i]];
    }

    // ì„ì¸ ê°’ë“¤ì„ ë‹¤ì‹œ DOMì— ë°˜ì˜
    interiorIndexes.forEach((tileIdx, i) => {
        const pieceNum = interiorPieces[i];
        const tile = tiles[tileIdx];
        tile.dataset.piece = pieceNum;
        applyBackgroundPosition(tile, pieceNum);
    });

    clearSelection();
    moveCounter = 0;
    updateMoveCount();
}

  // ===== ë¦¬ì…‹ (ì›ë˜ ê·¸ë¦¼ ìˆœì„œë¡œ ì •ë ¬) =====
  function resetPieces() {
    const tiles = document.querySelectorAll(".piece");
    tiles.forEach((tile, idx) => {
      tile.dataset.piece = idx;
      applyBackgroundPosition(tile, idx);
    });
    clearSelection();
    moveCounter = 0;
    updateMoveCount();
  }

  // ===== ì™„ì„± ì—¬ë¶€ ì²´í¬ =====
  function checkComplete() {
    const tiles = document.querySelectorAll(".piece");
    let ok = true;

    tiles.forEach((tile, idx) => {
      const pieceNum = parseInt(tile.dataset.piece, 10);
      if (pieceNum !== idx) ok = false;
    });

    if (ok) {
      setTimeout(() => {
        alert("í¼ì¦ ì™„ì„±! ğŸ‰\nì´ë™ íšŸìˆ˜: " + moveCounter + "íšŒ");
      }, 100);
    }
  }

  function updateMoveCount() {
    moveCountSpan.textContent = "ì´ë™ íšŸìˆ˜: " + moveCounter;
  }

  // ë²„íŠ¼ ì´ë²¤íŠ¸
  document.getElementById("shuffleBtn").addEventListener("click", shuffle);
  document.getElementById("resetBtn").addEventListener("click", resetPieces);

  // ì²˜ìŒ ë¡œë”© ì‹œ ì‹¤í–‰
  window.addEventListener("load", init);
</script>

</body>
</html>
